## Solution to D^3CTF2021 Zigzag Encryptor

1. 分析程序中的 Zigzag 编码方式，可以发现其将待编码数据中的每 3 个 bytes 打乱后存储在了每个锯齿图形的 RGB 颜色中，并且将打乱的方式（3 个数一共只有 6 种排列，所以只有 6 种打乱方式）也存储在了固定的位置。据此可以还原出 Zigzag 编码前的数据（也就是 LFSR 加密过后的密文）。
2. 分析 LFSR 密钥流生成器以及加密逻辑，可以发现 LFSR 的位数为 128，已知明文前缀（`D^3CTF2021_SECURE_MESSAGE_PREFIX: `, 末尾有空格，共 34 bytes）位数 > 2*128，可以进行已知明文攻击。因此可以直接构建方程组，求解出 LFSR 使用的多项式。
3. 使用已知的密钥（LFSR 使用的多项式、初始化向量）重新生成密钥序列，异或 LFSR 加密过后的密文即可得到全部明文，其中包含 flag。

详见解题脚本。